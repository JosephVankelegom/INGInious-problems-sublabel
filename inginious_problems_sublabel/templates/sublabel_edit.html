{# This file is part of INGInious. See the LICENSE and the COPYRIGHTS files for #}
{# more information about the licensing of this file. #}


<div class="form-group row">
    <label for="header-PID" class="col-sm-2 control-label">Context</label>
    <div class="col-sm-10">
        <textarea id="header-PID" class="form-control" name="problem[PID][header]"></textarea>
        <button id="highlight_button"> highlight </button>
    </div>
</div>

<div class="form-group row">
    <label for="answer-PID" class="col-sm-2 control-label">Answer</label>
    <div class="col-sm-10">
        <input type="text" class="form-control" id="answer-PID" name="problem[PID][answer]" placeholder="Leave empty for Docker assessment"/>
    </div>
</div>


<div class="form-group row">
    <label for="codeTest-PID" class="col-sm-2 control-label">Code</label>
    <textarea id="codeTest-PID" class="codeTest" name="problem[PID][codeTest]">{{ codeTest }}</textarea>
    <button id="eraseButton" type="button">Click me to erase answer</button>
</div>
<div class="form-group row">
    <label for="values-PID" class="col-sm-2 control-label">Values</label>
    <textarea id="values-PID" class="codeTest" name="problem[PID][values]"></textarea>
    <button id="updateValues" type="button">Click me to update values</button>
</div>



<script>
    $(document).ready(function() {

        let highlightValueArray = []; // indexes of highlighted text is situated.
        let textarea = $('#codeTest-PID')
        textarea.highlightWithinTextarea({ highlight: highlightValueArray });

        function updateValues() {
            textarea.highlightWithinTextarea('destroy');
            textarea.highlightWithinTextarea({ highlight: highlightValueArray });
            document.getElementById("answer-PID").value= highlightValueArray.toString();
        }


        document.getElementById('highlight_button').addEventListener('mousedown', function() {
            const codeAreaval = document.getElementById('codeTest-PID');
            let selS = codeAreaval.selectionStart;
            let selE = codeAreaval.selectionEnd;
            highlightValueArray.push([selS,selE]);
            highlightValueArray.sort()
            updateValues();

        })

        document.getElementById('eraseButton').addEventListener('click', function () {
            highlightValueArray=[]
            updateValues()
        })
        {# $('#eraseButton').on("mousedown",updateValues); #}


    });
</script>


{#
<div class="form-group row">
    <label for="codeInput-sublabel" class="col-sm-2 control-label">CodeInput</label>
    <div class="col-sm-10">
        <textarea id="codeInput-sublabel" class="form-control" oninput="updateText()" name="problem[sublabel][codeInput]" oncontextmenu="highlightFromIndexes(this)"></textarea>
    </div>
    <label for="codeHighlight" class="col-sm-2 control-label">Code Highlighted</label>
    <div class="col-sm-10">
        <div id="codeHighlight" class="codeHighlight" oncontextmenu="showSelection(this)"></div>
    </div>
</div>
#}











    

